<!DOCTYPE html>
<html>
<head>
    <title>ä»»åŠ¡é¢†å–ä¸­å¿ƒ</title>
    <style>
        body {
            font-family: Microsoft YaHei, sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            background: #f5f5f5;
        }
        .banner {
            border: 2px solid #ff4444;
            padding: 15px;
            margin: 20px 0;
            background: #fff8e1;
            border-radius: 10px;
        }
        .button {
            padding: 12px 24px;
            margin: 10px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: 0.3s;
        }
        #step1 { background: #4CAF50; }
        #step1:disabled { background: #cccccc; }
        #step2 { background: #2196F3; }
        #step2:disabled { background: #cccccc; }
        #copyBtn { background: #9C27B0; }
        select, input {
            padding: 8px;
            margin: 5px;
            width: 200px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .warning { color: red; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="banner">
        <h3>ğŸ“¢ ä»»åŠ¡å…¬å‘Š</h3>
        <p>â–¶ å®Œæˆä»¥ä¸‹å†…å®¹é¢†å–æ‹‰æ»¡å¥–åŠ±</p>
        <p>â–¶ åšå®Œä»»åŠ¡æ‰¾ç¾¤ä¸»å‘é€ï¼š</p>
        <p>âœ” æ‚¨çš„æ‰‹æœºå·ç </p>
        <p>âœ” æ‰‹æœºç±»å‹ï¼ˆè‹¹æœ/å®‰å“ï¼‰</p>
        <p>âœ” æ¸¸æˆæ¸ é“ï¼ˆ4399/top/å®˜æœ/è‹¹æœå®˜æœï¼‰</p>
        <p>â—ï¸å‘é€ä¿¡æ¯å®Œæˆç¬¬ä¸€æ—¶é—´æˆªå›¾å‘ç»™æˆ‘è¿‡æ—¶è¿˜è¦é‡æ–°å‘ä»¥é¿å…ä¸å¿…è¦çš„éº»çƒ¦â—ï¸<p>
    </div>

    <div id="wechatWarning" class="warning" style="display: none;">
        âš  æ£€æµ‹åˆ°å¾®ä¿¡æµè§ˆå™¨ï¼Œè¯·ç‚¹å‡»å³ä¸Šè§’ä½¿ç”¨ç³»ç»Ÿæµè§ˆå™¨æ‰“å¼€ï¼
    </div>

    <div>
        <input type="tel" id="userPhone" placeholder="è¯·è¾“å…¥æ‚¨çš„æ‰‹æœºå·" pattern="[0-9]{11}">
        <select id="channel">
            <option value="">é€‰æ‹©æ¸ é“</option>
            <option>4399</option>
            <option>top</option>
            <option>å®˜æœ</option>
            <option>è‹¹æœå®˜æœ</option>
        </select>
        <select id="deviceType">
            <option value="">é€‰æ‹©æ‰‹æœºç±»å‹</option>
            <option>è‹¹æœ</option>
            <option>å®‰å“</option>
        </select>
    </div>

    <button class="button" id="step1">ç¬¬ä¸€æ­¥</button>
    <button class="button" id="step2">ç¬¬äºŒæ­¥</button>
    <button class="button" id="copyBtn">ä¸€é”®å¤åˆ¶æ‰‹æœºä¿¡æ¯</button>

    <script>
        // å¾®ä¿¡æµè§ˆå™¨æ£€æµ‹
        if (/micromessenger/i.test(navigator.userAgent)) {
            document.getElementById('wechatWarning').style.display = 'block';
        }

        // çŸ­ä¿¡é…ç½®
        const SMS_SETTINGS = {
            number: "106988881700511", // å›½å†…æœåŠ¡å·ç æ ¼å¼
            messages: {
                step1: "1",
                step2: "æ³¨å†Œqq"
            }
        };

        // çŠ¶æ€åˆå§‹åŒ–
        function initState() {
            ['step1', 'step2'].forEach(step => {
                if (!localStorage.getItem(step)) {
                    localStorage.setItem(step, 'false');
                }
            });
            document.getElementById('step2').disabled = 
                localStorage.getItem('step1') === 'false';
        }
        initState();

        // çŸ­ä¿¡å‘é€æ ¸å¿ƒæ–¹æ³•
        function handleSMSSending(step) {
            try {
                const content = SMS_SETTINGS.messages[`step${step}`];
                const smsURI = `sms:${SMS_SETTINGS.number}?body=${encodeURIComponent(content)}`;
                
                // ä¼˜å…ˆå°è¯•ç›´æ¥è·³è½¬
                window.location.href = smsURI;
                
                // å…¼å®¹æ€§å¤‡ä»½æ–¹æ¡ˆ
                const backupSend = () => {
                    const link = document.createElement('a');
                    link.href = smsURI;
                    link.style.display = 'none';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                };

                // åŒé‡è§¦å‘æœºåˆ¶
                setTimeout(backupSend, 300);

                // æ›´æ–°ä»»åŠ¡çŠ¶æ€
                localStorage.setItem(`step${step}`, 'true');
                document.getElementById(`step${step}`).disabled = true;
                if(step === 1) {
                    document.getElementById('step2').disabled = false;
                }

                // å‘é€çŠ¶æ€æ£€æµ‹
                setTimeout(() => {
                    if (!document.hidden) {
                        const confirmMsg = [
                            `çŸ­ä¿¡å‘é€åˆ°ï¼š${SMS_SETTINGS.number}`,
                            `çŸ­ä¿¡å†…å®¹ï¼š${content}`,
                            "ç‚¹å‡»ç¡®å®šå¤åˆ¶ä¿¡æ¯åˆ°å‰ªè´´æ¿"
                        ].join("\n");
                        
                        if (confirm(confirmMsg)) {
                            navigator.clipboard.writeText(`${SMS_SETTINGS.number} ${content}`);
                        }
                    }
                }, 4500);

            } catch (error) {
                alert(`æ“ä½œå¤±è´¥ï¼š${error.message}`);
            }
        }

        // äº‹ä»¶ç»‘å®š
        document.getElementById('step1').addEventListener('click', () => handleSMSSending(1));
        document.getElementById('step2').addEventListener('click', () => handleSMSSending(2));
        document.getElementById('copyBtn').addEventListener('click', function() {
            const isValid = document.getElementById('userPhone').checkValidity();
            const isComplete = localStorage.getItem('step1') === 'true' && 
                              localStorage.getItem('step2') === 'true';

            if (isValid && isComplete) {
                const info = [
                    `æ‰‹æœºå·ï¼š${document.getElementById('userPhone').value}`,
                    `æ¸ é“ï¼š${document.getElementById('channel').value}`,
                    `è®¾å¤‡ç±»å‹ï¼š${document.getElementById('deviceType').value}`
                ].join("\n");

                navigator.clipboard.writeText(info)
                    .then(() => alert('å¤åˆ¶æˆåŠŸï¼'))
                    .catch(() => alert('è‡ªåŠ¨å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©æ–‡æœ¬å¤åˆ¶'));
            } else {
                alert('è¯·å…ˆå®Œæˆæ‰€æœ‰æ­¥éª¤å¹¶æ­£ç¡®å¡«å†™ä¿¡æ¯ï¼');
            }
        });
    </script>
</body>
</html>